"Ythan" = "Ythan", "Broadstone Stream size_agg" = "Broadstone Stream (size aggregation)")
plot_lc_R50_slope <- dd_all %>%
filter(is.finite(slope)) %>%
ggplot() +
geom_boxplot(aes(x = fw_name, y = slope), alpha = 0.5, outlier.shape = NA) +
geom_abline(slope = 0, intercept = 0, linetype = 2) +
theme_classic() +
ylim(c(-0.5, 0.5)) +
geom_point(data = dd_all_mean, mapping = aes(x = fw_name, y = mean_slope), color = "red", size = 3) +
# ylab(expression(paste(frac(paste(Delta, R[50], "/", R[50]) , paste(Delta, connectance, "/", connectance))))) +
ylab("") +
xlab("") +
scale_x_discrete(labels = fw_labs) +
ggtitle("(c) Least connected") +
theme(plot.title = element_text(hjust = 0.5), axis.text.y = element_blank(), axis.ticks.y = element_blank()) +
coord_flip()
dd_all_main
dd_all_main %>%
filter(is.finite(slope)) %>%
ggplot() +
geom_boxplot(aes(x = fw_name, y = slope), alpha = 0.5, outlier.shape = NA) +
geom_abline(slope = 0, intercept = 0, linetype = 2) +
theme_classic() +
ylim(c(-0.5, 0.5)) +
# geom_point(data = dd_all_mean, mapping = aes(x = fw_name, y = mean_slope), color = "red", size = 3) +
# ylab(expression(paste(frac(paste(Delta, R[50], "/", R[50]) , paste(Delta, connectance, "/", connectance))))) +
ylab("") +
xlab("") +
scale_x_discrete(labels = fw_labs) +
# ggtitle("(c) Least connected") +
theme(plot.title = element_text(hjust = 0.5), axis.text.y = element_blank(), axis.ticks.y = element_blank()) +
coord_flip()
dd_all_main %>%
filter(is.finite(slope)) %>%
ggplot() +
geom_boxplot(aes(x = fw_name, y = slope), alpha = 0.5, outlier.shape = NA) +
facet_wrap(~study) +
geom_abline(slope = 0, intercept = 0, linetype = 2) +
theme_classic() +
ylim(c(-0.5, 0.5)) +
# geom_point(data = dd_all_mean, mapping = aes(x = fw_name, y = mean_slope), color = "red", size = 3) +
# ylab(expression(paste(frac(paste(Delta, R[50], "/", R[50]) , paste(Delta, connectance, "/", connectance))))) +
ylab("") +
xlab("") +
scale_x_discrete(labels = fw_labs) +
# ggtitle("(c) Least connected") +
theme(plot.title = element_text(hjust = 0.5), axis.text.y = element_blank(), axis.ticks.y = element_blank()) +
coord_flip()
dd_all_main %>%
filter(is.finite(slope)) %>%
ggplot() +
geom_boxplot(aes(x = fw_name, y = slope), alpha = 0.5, outlier.shape = NA) +
facet_wrap(~study) +
geom_abline(slope = 0, intercept = 0, linetype = 2) +
theme_classic() +
ylim(c(-0.5, 0.5)) +
# geom_point(data = dd_all_mean, mapping = aes(x = fw_name, y = mean_slope), color = "red", size = 3) +
# ylab(expression(paste(frac(paste(Delta, R[50], "/", R[50]) , paste(Delta, connectance, "/", connectance))))) +
ylab("") +
xlab("") +
scale_x_discrete(labels = fw_labs) +
# ggtitle("(c) Least connected") +
theme(plot.title = element_text(hjust = 0.5)) +
coord_flip()
dd_all_main %>%
filter(is.finite(slope)) %>%
ggplot() +
geom_boxplot(aes(x = fw_name, y = slope), alpha = 0.5, outlier.shape = NA) +
facet_wrap(~study) +
geom_abline(slope = 0, intercept = 0, linetype = 2) +
theme_classic() +
# ylim(c(-0.5, 0.5)) +
# geom_point(data = dd_all_mean, mapping = aes(x = fw_name, y = mean_slope), color = "red", size = 3) +
# ylab(expression(paste(frac(paste(Delta, R[50], "/", R[50]) , paste(Delta, connectance, "/", connectance))))) +
ylab("") +
xlab("") +
scale_x_discrete(labels = fw_labs) +
# ggtitle("(c) Least connected") +
theme(plot.title = element_text(hjust = 0.5)) +
coord_flip()
dd_all_main %>%
filter(is.finite(slope)) %>%
ggplot() +
geom_boxplot(aes(x = fw_name, y = slope), alpha = 0.5, outlier.shape = NA) +
facet_wrap(~study) +
geom_abline(slope = 0, intercept = 0, linetype = 2) +
theme_classic() +
ylim(c(-0.5, 0.5)) +
# geom_point(data = dd_all_mean, mapping = aes(x = fw_name, y = mean_slope), color = "red", size = 3) +
# ylab(expression(paste(frac(paste(Delta, R[50], "/", R[50]) , paste(Delta, connectance, "/", connectance))))) +
ylab("") +
xlab("") +
scale_x_discrete(labels = fw_labs) +
# ggtitle("(c) Least connected") +
theme(plot.title = element_text(hjust = 0.5)) +
coord_flip()
dd_all_main %>%
filter(is.finite(slope)) %>%
ggplot() +
geom_boxplot(aes(x = fw_name, y = slope), alpha = 0.5, outlier.shape = NA) +
facet_wrap(~study) +
geom_abline(slope = 0, intercept = 0, linetype = 2) +
theme_classic() +
ylim(c(-0.5, 0.5)) +
geom_point(data = dd_all_mean_main, mapping = aes(x = fw_name, y = mean_slope), color = "red", size = 3) +
facet_wrap(~study) +
# ylab(expression(paste(frac(paste(Delta, R[50], "/", R[50]) , paste(Delta, connectance, "/", connectance))))) +
ylab("") +
xlab("") +
scale_x_discrete(labels = fw_labs) +
# ggtitle("(c) Least connected") +
theme(plot.title = element_text(hjust = 0.5)) +
coord_flip()
dummy <- rbind(data.frame(slope = c(-2, 2), study = "(a) Most connected", stringsAsFactors=FALSE),
data.frame(slope = c(-0.3, 0.3), study = "(b) Random", stringsAsFactors=FALSE),
data.frame(slope = c(-0.5, 0.5), study = "(c) Least connected", stringsAsFactors=FALSE))
dd_all_main %>%
filter(is.finite(slope)) %>%
ggplot() +
geom_boxplot(aes(x = fw_name, y = slope), alpha = 0.5, outlier.shape = NA) +
facet_wrap(~study) +
geom_abline(slope = 0, intercept = 0, linetype = 2) +
theme_classic() +
ylim(c(-0.5, 0.5)) +
geom_point(data = dd_all_mean_main, mapping = aes(x = fw_name, y = mean_slope), color = "red", size = 3) +
facet_wrap(~study) +
# ylab(expression(paste(frac(paste(Delta, R[50], "/", R[50]) , paste(Delta, connectance, "/", connectance))))) +
geom_blank(data = dummy, mapping = aes(y = slope)) +
ylab("") +
xlab("") +
scale_x_discrete(labels = fw_labs) +
# ggtitle("(c) Least connected") +
theme(plot.title = element_text(hjust = 0.5)) +
coord_flip()
dd_all_main %>%
filter(is.finite(slope)) %>%
ggplot() +
geom_boxplot(aes(x = fw_name, y = slope), alpha = 0.5, outlier.shape = NA) +
facet_wrap(~study) +
geom_abline(slope = 0, intercept = 0, linetype = 2) +
theme_classic() +
ylim(c(-0.5, 0.5)) +
geom_point(data = dd_all_mean_main, mapping = aes(x = fw_name, y = mean_slope), color = "red", size = 3) +
# ylab(expression(paste(frac(paste(Delta, R[50], "/", R[50]) , paste(Delta, connectance, "/", connectance))))) +
geom_blank(data = dummy, mapping = aes(y = slope)) +
ylab("") +
xlab("") +
scale_x_discrete(labels = fw_labs) +
# ggtitle("(c) Least connected") +
theme(plot.title = element_text(hjust = 0.5)) +
coord_flip()
dd_all_main %>%
filter(is.finite(slope)) %>%
ggplot() +
geom_boxplot(aes(x = fw_name, y = slope), alpha = 0.5, outlier.shape = NA) +
facet_wrap(~study) +
geom_abline(slope = 0, intercept = 0, linetype = 2) +
theme_classic() +
ylim(c(-0.5, 0.5)) +
geom_point(data = dd_all_mean_main, mapping = aes(x = fw_name, y = mean_slope), color = "red", size = 3) +
# ylab(expression(paste(frac(paste(Delta, R[50], "/", R[50]) , paste(Delta, connectance, "/", connectance))))) +
geom_blank(data = dummy, mapping = aes(x = slope)) +
ylab("") +
xlab("") +
scale_x_discrete(labels = fw_labs) +
# ggtitle("(c) Least connected") +
theme(plot.title = element_text(hjust = 0.5)) +
coord_flip()
dummy
dd_all_main %>%
filter(is.finite(slope)) %>%
ggplot() +
geom_boxplot(aes(x = fw_name, y = slope), alpha = 0.5, outlier.shape = NA) +
facet_wrap(~study) +
geom_abline(slope = 0, intercept = 0, linetype = 2) +
theme_classic() +
ylim(c(-0.5, 0.5)) +
geom_point(data = dd_all_mean_main, mapping = aes(x = fw_name, y = mean_slope), color = "red", size = 3) +
# ylab(expression(paste(frac(paste(Delta, R[50], "/", R[50]) , paste(Delta, connectance, "/", connectance))))) +
geom_blank(data = dummy, mapping = aes(x = slope)) +
ylab("") +
xlab("") +
scale_x_discrete(labels = fw_labs) +
# ggtitle("(c) Least connected") +
theme(plot.title = element_text(hjust = 0.5))
dd_all_main %>%
filter(is.finite(slope)) %>%
ggplot() +
geom_boxplot(aes(x = fw_name, y = slope), alpha = 0.5, outlier.shape = NA) +
facet_wrap(~study, scales = "free") +
geom_abline(slope = 0, intercept = 0, linetype = 2) +
theme_classic() +
ylim(c(-0.5, 0.5)) +
geom_point(data = dd_all_mean_main, mapping = aes(x = fw_name, y = mean_slope), color = "red", size = 3) +
# ylab(expression(paste(frac(paste(Delta, R[50], "/", R[50]) , paste(Delta, connectance, "/", connectance))))) +
geom_blank(data = dummy, mapping = aes(x = slope)) +
ylab("") +
xlab("") +
scale_x_discrete(labels = fw_labs) +
# ggtitle("(c) Least connected") +
theme(plot.title = element_text(hjust = 0.5)) +
coord_flip()
dd_all_main %>%
filter(is.finite(slope)) %>%
ggplot() +
geom_boxplot(aes(x = fw_name, y = slope), alpha = 0.5, outlier.shape = NA) +
facet_wrap(~study, scales = "free_x") +
geom_abline(slope = 0, intercept = 0, linetype = 2) +
theme_classic() +
ylim(c(-0.5, 0.5)) +
geom_point(data = dd_all_mean_main, mapping = aes(x = fw_name, y = mean_slope), color = "red", size = 3) +
# ylab(expression(paste(frac(paste(Delta, R[50], "/", R[50]) , paste(Delta, connectance, "/", connectance))))) +
geom_blank(data = dummy, mapping = aes(x = slope)) +
ylab("") +
xlab("") +
scale_x_discrete(labels = fw_labs) +
# ggtitle("(c) Least connected") +
theme(plot.title = element_text(hjust = 0.5)) +
coord_flip()
dd_all_main %>%
filter(is.finite(slope)) %>%
ggplot() +
geom_boxplot(aes(x = fw_name, y = slope), alpha = 0.5, outlier.shape = NA) +
facet_wrap(~study, scales = "free_x") +
geom_abline(slope = 0, intercept = 0, linetype = 2) +
theme_classic() +
ylim(c(-0.5, 0.5)) +
geom_point(data = dd_all_mean_main, mapping = aes(x = fw_name, y = mean_slope), color = "red", size = 3) +
# ylab(expression(paste(frac(paste(Delta, R[50], "/", R[50]) , paste(Delta, connectance, "/", connectance))))) +
geom_blank(data = dummy, mapping = aes(y = slope)) +
ylab("") +
xlab("") +
scale_x_discrete(labels = fw_labs) +
# ggtitle("(c) Least connected") +
theme(plot.title = element_text(hjust = 0.5)) +
coord_flip()
dd_all_main %>%
filter(is.finite(slope)) %>%
ggplot() +
geom_boxplot(aes(x = fw_name, y = slope), alpha = 0.5, outlier.shape = NA) +
facet_wrap(~study, scales = "free_x") +
geom_abline(slope = 0, intercept = 0, linetype = 2) +
theme_classic() +
ylim(c(-0.5, 0.5)) +
geom_point(data = dd_all_mean_main, mapping = aes(x = fw_name, y = mean_slope), color = "red", size = 3) +
# ylab(expression(paste(frac(paste(Delta, R[50], "/", R[50]) , paste(Delta, connectance, "/", connectance))))) +
geom_blank(data = dummy,) +
ylab("") +
xlab("") +
scale_x_discrete(labels = fw_labs) +
# ggtitle("(c) Least connected") +
theme(plot.title = element_text(hjust = 0.5)) +
coord_flip()
dd_all_main %>%
filter(is.finite(slope)) %>%
ggplot() +
geom_boxplot(aes(x = fw_name, y = slope), alpha = 0.5, outlier.shape = NA) +
facet_wrap(~study, scales = "free_x") +
geom_abline(slope = 0, intercept = 0, linetype = 2) +
theme_classic() +
# ylim(c(-0.5, 0.5)) +
geom_point(data = dd_all_mean_main, mapping = aes(x = fw_name, y = mean_slope), color = "red", size = 3) +
# ylab(expression(paste(frac(paste(Delta, R[50], "/", R[50]) , paste(Delta, connectance, "/", connectance))))) +
geom_blank(data = dummy, mapping = aes(y = slope)) +
ylab("") +
xlab("") +
scale_x_discrete(labels = fw_labs) +
# ggtitle("(c) Least connected") +
theme(plot.title = element_text(hjust = 0.5)) +
coord_flip()
dd_all_main %>%
filter(is.finite(slope)) %>%
ggplot() +
geom_boxplot(aes(x = fw_name, y = slope), alpha = 0.5, outlier.shape = NA) +
facet_wrap(~study, scales = "free_x") +
geom_abline(slope = 0, intercept = 0, linetype = 2) +
theme_classic() +
# ylim(c(-0.5, 0.5)) +
geom_point(data = dd_all_mean_main, mapping = aes(x = fw_name, y = mean_slope), color = "red", size = 3) +
# ylab(expression(paste(frac(paste(Delta, R[50], "/", R[50]) , paste(Delta, connectance, "/", connectance))))) +
geom_blank(data = dummy, mapping = aes(x = slope)) +
ylab("") +
xlab("") +
scale_x_discrete(labels = fw_labs) +
# ggtitle("(c) Least connected") +
theme(plot.title = element_text(hjust = 0.5)) +
coord_flip()
dd_all_main %>%
filter(is.finite(slope)) %>%
ggplot() +
geom_boxplot(aes(x = fw_name, y = slope), alpha = 0.5, outlier.shape = NA) +
facet_wrap(~study, scales = "free_y") +
geom_abline(slope = 0, intercept = 0, linetype = 2) +
theme_classic() +
# ylim(c(-0.5, 0.5)) +
geom_point(data = dd_all_mean_main, mapping = aes(x = fw_name, y = mean_slope), color = "red", size = 3) +
# ylab(expression(paste(frac(paste(Delta, R[50], "/", R[50]) , paste(Delta, connectance, "/", connectance))))) +
geom_blank(data = dummy, mapping = aes(x = slope)) +
ylab("") +
xlab("") +
scale_x_discrete(labels = fw_labs) +
# ggtitle("(c) Least connected") +
theme(plot.title = element_text(hjust = 0.5)) +
coord_flip()
dd_all_main %>%
filter(is.finite(slope)) %>%
ggplot() +
geom_boxplot(aes(x = fw_name, y = slope), alpha = 0.5, outlier.shape = NA) +
facet_wrap(~study, scales = "free_x") +
geom_abline(slope = 0, intercept = 0, linetype = 2) +
theme_classic() +
# ylim(c(-0.5, 0.5)) +
geom_point(data = dd_all_mean_main, mapping = aes(x = fw_name, y = mean_slope), color = "red", size = 3) +
# ylab(expression(paste(frac(paste(Delta, R[50], "/", R[50]) , paste(Delta, connectance, "/", connectance))))) +
geom_blank(data = dummy, mapping = aes(x = slope)) +
ylab("") +
xlab("") +
scale_x_discrete(labels = fw_labs) +
# ggtitle("(c) Least connected") +
theme(plot.title = element_text(hjust = 0.5)) +
coord_flip()
dd_all_main %>%
filter(is.finite(slope)) %>%
ggplot() +
geom_boxplot(aes(x = fw_name, y = slope), alpha = 0.5, outlier.shape = NA) +
facet_wrap(~study, scales = "free") +
geom_abline(slope = 0, intercept = 0, linetype = 2) +
theme_classic() +
# ylim(c(-0.5, 0.5)) +
geom_point(data = dd_all_mean_main, mapping = aes(x = fw_name, y = mean_slope), color = "red", size = 3) +
# ylab(expression(paste(frac(paste(Delta, R[50], "/", R[50]) , paste(Delta, connectance, "/", connectance))))) +
geom_blank(data = dummy, mapping = aes(x = slope)) +
ylab("") +
xlab("") +
scale_x_discrete(labels = fw_labs) +
# ggtitle("(c) Least connected") +
theme(plot.title = element_text(hjust = 0.5)) +
coord_flip()
dd_all_main %>%
filter(is.finite(slope)) %>%
ggplot() +
geom_boxplot(aes(x = fw_name, y = slope), alpha = 0.5, outlier.shape = NA) +
facet_wrap(~study, scales = "free_x") +
geom_abline(slope = 0, intercept = 0, linetype = 2) +
theme_classic() +
# ylim(c(-0.5, 0.5)) +
geom_point(data = dd_all_mean_main, mapping = aes(x = fw_name, y = mean_slope), color = "red", size = 3) +
# ylab(expression(paste(frac(paste(Delta, R[50], "/", R[50]) , paste(Delta, connectance, "/", connectance))))) +
geom_blank(data = dummy, mapping = aes(x = slope)) +
ylab("") +
xlab("") +
scale_x_discrete(labels = fw_labs) +
# ggtitle("(c) Least connected") +
theme(plot.title = element_text(hjust = 0.5)) +
coord_flip()
dd_all_main %>%
filter(is.finite(slope)) %>%
ggplot() +
geom_boxplot(aes(x = fw_name, y = slope), alpha = 0.5, outlier.shape = NA) +
facet_wrap(~study, scales = "free_x") +
geom_abline(slope = 0, intercept = 0, linetype = 2) +
theme_classic() +
# ylim(c(-0.5, 0.5)) +
geom_point(data = dd_all_mean_main, mapping = aes(x = fw_name, y = mean_slope), color = "red", size = 3) +
# ylab(expression(paste(frac(paste(Delta, R[50], "/", R[50]) , paste(Delta, connectance, "/", connectance))))) +
geom_blank(data = dummy, mapping = aes(x = slope)) +
ylab("") +
xlab("") +
scale_x_discrete(labels = fw_labs) +
# ggtitle("(c) Least connected") +
theme(plot.title = element_text(hjust = 0.5)) +
coord_flip()
dd_all_main %>%
filter(is.finite(slope)) %>%
ggplot() +
# geom_boxplot(aes(x = fw_name, y = slope), alpha = 0.5, outlier.shape = NA) +
facet_wrap(~study, scales = "free_x") +
geom_abline(slope = 0, intercept = 0, linetype = 2) +
theme_classic() +
# ylim(c(-0.5, 0.5)) +
geom_point(data = dd_all_mean_main, mapping = aes(x = fw_name, y = mean_slope), color = "red", size = 3) +
# ylab(expression(paste(frac(paste(Delta, R[50], "/", R[50]) , paste(Delta, connectance, "/", connectance))))) +
geom_blank(data = dummy, mapping = aes(x = slope)) +
ylab("") +
xlab("") +
scale_x_discrete(labels = fw_labs) +
# ggtitle("(c) Least connected") +
theme(plot.title = element_text(hjust = 0.5)) +
coord_flip()
?geom_blank
dd_all_main %>%
filter(is.finite(slope)) %>%
ggplot() +
geom_boxplot(aes(x = fw_name, y = slope), alpha = 0.5, outlier.shape = NA) +
facet_wrap(~study, scales = "free_x") +
geom_abline(slope = 0, intercept = 0, linetype = 2) +
theme_classic() +
# ylim(c(-0.5, 0.5)) +
geom_point(data = dd_all_mean_main, mapping = aes(x = fw_name, y = mean_slope), color = "red", size = 3) +
# ylab(expression(paste(frac(paste(Delta, R[50], "/", R[50]) , paste(Delta, connectance, "/", connectance))))) +
geom_blank(data = dummy, mapping = aes(x = slope)) +
ylab("") +
xlab("") +
scale_x_discrete(labels = fw_labs) +
# ggtitle("(c) Least connected") +
theme(plot.title = element_text(hjust = 0.5)) +
coord_flip()
?geom_boxplot
geom_boxplot2
?geom_boxplot2
library("gg.layers")
rm(list = ls())
library(R.utils)
library(NetworkExtinction)
library(network)
library(readxl)
library(dplyr)
library(ggplot2)
library(doParallel)
sourceDirectory("../C1_method/R", modifiedOnly=FALSE)
sourceDirectory("R", modifiedOnly=FALSE)
# For removing random nodes
dd_rand <- data.frame(n_ext = double(),
acc_sec_ext = integer(),
nsim_rand = integer(),
nsim = integer(),
type = character(),
fw_name = character(),
S = integer(),
L = integer())
# Getting the foodweb name and tolerance
metadata_fw_tol <- read_excel("~/Google Drive/GitHub/C1_method_v2/data/parameter_values.xlsx")
n_fw <- length(metadata_fw_tol$foodweb)
fw_ind <- 1:n_fw
Nsim <- 100
for(i in fw_ind){
fw_name <- metadata_fw_tol$foodweb[i]
fw_tol <- metadata_fw_tol$dist_rej[i]
real_pred_mat <- readRDS(paste0("../C1_data/data/", fw_name, ".web.RDS"))$predation.matrix
if(is.null(rownames(real_pred_mat))){
n_nodes <- dim(real_pred_mat)[1]
rownames(real_pred_mat) <- as.character(1:n_nodes)
colnames(real_pred_mat) <- as.character(1:n_nodes)
}
S <- dim(real_pred_mat)[1]
L_real <- sum(real_pred_mat)
real_conn <- sum(real_pred_mat)/(dim(real_pred_mat)[1]^2)
real_ext_rand <- random_ext_parallel(net = real_pred_mat, nsim = Nsim, n_cores = 5)
dd_rand <- rbind(dd_rand,
data.frame(n_ext = real_ext_rand$acc_pri_ext,
acc_sec_ext = real_ext_rand$acc_sec_ext,
nsim_rand = real_ext_rand$nsim,
nsim = 1,
type = "Empirical",
fw_name = fw_name,
S = S,
L = L_real))
for(j in 1:1000){
ADBM_ABC_fw_calc <- ADBM_ABC_fw_all(fw_name = fw_name, fw_tol = fw_tol, nsim = j)
ADBM_ABC_pred_mat <- ADBM_ABC_fw_calc$ADBM_pred_mat
L_ADBM_ABC <- sum(ADBM_ABC_pred_mat)
ADBM_ABC_conn <- sum(ADBM_ABC_pred_mat)/(dim(ADBM_ABC_pred_mat)[1]^2)
ADBM_ABC_ext_rand <- random_ext_parallel(net = ADBM_ABC_pred_mat, nsim = Nsim, n_cores = 5)
dd_rand <- rbind(dd_rand,
data.frame(n_ext = ADBM_ABC_ext_rand$acc_pri_ext,
acc_sec_ext = ADBM_ABC_ext_rand$acc_sec_ext,
nsim_rand = ADBM_ABC_ext_rand$nsim,
nsim = j,
type = "ADBM",
fw_name = fw_name,
S = S,
L = L_ADBM_ABC))
}
print(fw_name)
}
saveRDS(object = dd_rand, file = "results/random_raw_uncertainty_july6.RDS")
broom_fw <- readRDS("../C1_data/data/Broom.web.RDS")
broom_fw <- broom_fw$predation.matrix
rm(list = ls())
broom_fw <- broom_fw$predation.matrix
saveRDS(object = dd_rand, file = "results/random_raw_uncertainty_july6.RDS")
broom_fw <- readRDS("../C1_data/data/Broom.web.RDS")
broom_fw <- broom_fw$predation.matrix
net <- broom_fw
indeg <- rowSums(net)
outdeg <- colSums(net)
totdeg <- indeg + outdeg
totdeg
as.numeric(broom_fw)
as.numeric(totdeg)
new_net <- net[!rownames(net) %in% node, !colnames(net) %in% node]
which.max(totdeg)
which.max(as.numeric(totdeg))
as.numeric(totdeg)
max(totdeg)
node <- "Arytaina genistae -999 Homoptera"
node
new_net <- net[!rownames(net) %in% node, !colnames(net) %in% node]
new_net
dim(new)
dim(net)
dim(new_net)
sum(new_net)
sum(net)
if(length(new_net) == 1){
new_net <- as.matrix(new_net)
lost_node <- setdiff(rownames(net), node)
rownames(new_net) <- lost_node
colnames(new_net) <- lost_node
}
length(new_net)
new_net
